<span><%= @today.year %></span>年
<span><%= @today.month %></span>月
<table>
  <thead>
    <tr>
      <th>担当者</th><th>日</th><th>月</th><th>火</th><th>水</th><th>木</th><th>金</th><th>土</th>
    </tr>
  </thead>
  <tbody>
    <% @weeks.each_with_index do |week, index| %>
      <tr>
        <% schedule = Schedule.find_by(first_date_of_week: week[0]) %>


        <% scule = Schedule.find_by(year: @today.year, month: @today.month, week: index + 1) %>
        <% schedule = schedule(@today.year, @today.month, index + 1, week[-1]) %>
        <td><%= schedule ? schedule.user.name : '' %></td>
        <% week.each do |date| %>
          <td><%= date.day %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>


def schedule(year, month, week_no, last_date_of_week)
  if last_date_of_week.month == month
    Schedule.find_by(year: @today.year, month: @today.month, week: week_no)
  else
    if month == 12
      Schedule.find_by(year: @today.year + 1, month: 1, week: 1)
    else
      Schedule.find_by(year: @today.year, month: @today.month + 1, week: 1)
    end
  end
end
